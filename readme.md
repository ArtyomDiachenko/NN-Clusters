# Применение Simulation-Based Inference для анализа распределения скоплений галактик

Для ограничения космологических параметров используется байесовский подход. Для этого необходимо сгенерировать выборку из апостериорного распределения, пропорционального произведению правдоподобия и априорного распределения. Для генерации выборки используются итеративные алгоритмы, такие как MCMC. 

Функция правдоподобия для распределения скоплений галактик содержит в себе многомерные интегралы, которые необходимо вычислять численно. Также, она зависит от большого количества мешающих параметров. Из-за этого, анализ методом MCMC занимает много времени. Альтернативный подход - simulation based inference, в котором нейросеть обучают на синтетических данных строить апостериорное распределение параметров. В данной работе представлен код обучения такой нейросети.

Рассматриваются 2 модели: упрощенные симуляции и симуляции каталога eFEDS. 

В папке data/simple_data содержатся данные для упрощенных симуляций, папка samples - содержит синтетические данные для обучения нейросети. prior.txt - содержит априорные распределения параметров. mcmc.npy - выборка из апостериорного распределения полученная методом MCMC для sample.npy.

В папке data/efeds_data содержатся данные для симуляций каталога eFEDS. Её структура аналогична структуре папки simple_data.

В папке models содержатся обученные модели.

В папке notebooks содержится код для обучения моделей. embedding_net.py - содержит архитектуру эмбеддинга. Custom_prior.py - содержит код для работы с априорными распределениями. simple_sim.ipynb и efeds_sim.ipynb - содержат код для обучения моделей.